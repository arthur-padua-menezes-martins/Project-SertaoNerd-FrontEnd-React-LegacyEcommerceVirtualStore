/*basic modules************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
import React, { useEffect } from 'react'

/*redux************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
import { connect } from 'react-redux'
import actions from '../../redux/actions/index.js'

/*components************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
import CartPageProducts from '../../Components/Table/CartPage/index.js'
import CartPagePaymentOptions from '../../Components/List/CartPage/options.js'

/*styled components************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
import { StyledContainerCartPage } from './styles.js'

/*helpers************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
import { } from '../../helpers/cart.js'

/*main function************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
function CartPage(props) {

    /*hooks************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
    useEffect(async () => {
        props.setThisCart(props.login.authentication.user_id)
    }, [])

    useEffect(() => {
        const { cart } = props

        if (cart !== null) {
            if (cart[0] && cart[0].products && !cart[0].products._id) {
                cart.forEach((item, index) => {
                    props.getCartProduct(item.products, index)
                })
            }
        }

    }, [props])




    /*return************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
    return (
        <StyledContainerCartPage>

            { props.cart !== null && props.cart[0] && props.cart[0].products ? (
                <>
                    <CartPageProducts mobileLayout={800} />

                    <CartPagePaymentOptions
                        display={'column'} width={'80%'} height={false}
                        subtotal={true} frete={false} total={false} delivery={false} payment={true} keepBuying={true} />
                </>
            ) : (
                    <></>
                )
            }

        </StyledContainerCartPage>
    )
}

const mapStateToProps = (state, ownProps) => ({
    ...state, cart: state.cart.cart, ownProps
})
export default connect(mapStateToProps, actions)(CartPage)