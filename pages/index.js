/*basic modules************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
import React, { useState, useEffect } from 'react'

/*redux************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
import { connect } from 'react-redux'
import actions from '../redux/actions/index.js'
import getBaseInfo from '../helpers/getBaseInfo.js'

/*components************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
import Layout from '../Components/Layout/index.js'

/*containers************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
import Header from '../Containers/Header/index.js'
import SubHeader from '../Containers/SubHeader/index.js'
import Banners from '../Containers/Banners/index.js'
import SubBanners from '../Containers/SubBanners/index.js'
import HomePageProducts from '../Containers/List/HomePageProducts/index.js'
import Footer from '../Containers/Footer/index.js'

/*main function************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
const Index = props => {


    if (typeof window !== 'undefined') {
        
        
        /*var's************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
        var
            GET_SUB_HEADERS,
            PROPS_KEYS = Object.keys(props).length
        
        /*state************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
        var [InitialInnerWidth, setInitialInnerWidth] = useState(window.innerWidth)




        /*hooks************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
        useEffect(() => {props.verifyAuthentication()}, [])
        


        
        /*auto invoked functions************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
        for (let i = 0; i < PROPS_KEYS; i++) {
            if (props[i] !== null && props[i] !== undefined)
                if (props[i].type === 'GET_SUB_HEADERS')
                    GET_SUB_HEADERS = props[i]
        }



        
        if (GET_SUB_HEADERS) {
            /*return desktop************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
            if (window.innerWidth > 720) { 
                return (
                    <Layout>

                        <Header
                            InitialInnerWidth={InitialInnerWidth}
                            setInitialInnerWidth={setInitialInnerWidth}
                            Desktop={true}
                            Mobile={false}
                            Default={true} />

                        <SubHeader
                            informations={GET_SUB_HEADERS.payload}
                            Desktop={true}
                            Mobile={false} />

                        <Banners />

                        <SubBanners />

                        <HomePageProducts
                            names={GET_SUB_HEADERS.payload.names}
                            types={GET_SUB_HEADERS.payload.types}
                            collections={GET_SUB_HEADERS.payload.collections} />

                        <Footer />

                    </Layout>
                )
            }

            /*return desktop************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
            if (window.innerWidth <= 720) {
                return (
                    <Layout>

                        <Header
                            InitialInnerWidth={InitialInnerWidth}
                            setInitialInnerWidth={setInitialInnerWidth}
                            Desktop={false}
                            Mobile={true}
                            Default={true} />

                        <Banners />

                        <SubBanners />

                        <HomePageProducts
                            names={GET_SUB_HEADERS.payload.names}
                            types={GET_SUB_HEADERS.payload.types}
                            collections={GET_SUB_HEADERS.payload.collections} />

                        <Footer />

                    </Layout>
                )
            }

        } else { 
            return (
                <></>
            )
        }

    } else {
        return (
            <></>
        )
    }

}

Index.getInitialProps = async (ctx) => {

    return getBaseInfo([
        actions.getSubHeaders
    ], ctx)

}

const mapStateToProps = (state, ownProps) => ({ ...state, ownProps })
export default connect(mapStateToProps, actions)(Index)